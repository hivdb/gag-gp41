
Analysis Description
--------------------
RELAX (a random effects test of selection relaxation) uses a random
effects branch-site model framework to test whether a set of 'Test'
branches evolves under relaxed selection relative to a set of
'Reference' branches (R), as measured by the relaxation parameter (K).

- __Requirements__: in-frame codon alignment and a phylogenetic tree, with at least two
groups of branches defined using the {} notation (one group can be
defined as all unlabeled branches)

- __Citation__: RELAX: Detecting Relaxed Selection in a Phylogenetic Framework (2015).
Mol Biol Evol 32 (3): 820-832

- __Written by__: Sergei L Kosakovsky Pond, Ben Murrell, Steven Weaver and Temple iGEM /
UCSD viral evolution group

- __Contact Information__: spond@temple.edu

- __Analysis Version__: 2.0



####Choose Genetic Code

1. [**Universal**] Universal code. (Genebank transl_table=1).
2. [**Vertebrate mtDNA**] Vertebrate mitochondrial DNA code. (Genebank transl_table=2).
3. [**Yeast mtDNA**] Yeast mitochondrial DNA code. (Genebank transl_table=3).
4. [**Mold/Protozoan mtDNA**] Mold, Protozoan and Coelenterate mitochondrial DNA and the Mycloplasma/Spiroplasma code. (Genebank transl_table=4).
5. [**Invertebrate mtDNA**] Invertebrate mitochondrial DNA code. (Genebank transl_table=5).
6. [**Ciliate Nuclear**] Ciliate, Dasycladacean and Hexamita Nuclear code. (Genebank transl_table=6).
7. [**Echinoderm mtDNA**] Echinoderm mitochondrial DNA code. (Genebank transl_table=9).
8. [**Euplotid Nuclear**] Euplotid Nuclear code. (Genebank transl_table=10).
9. [**Alt. Yeast Nuclear**] Alternative Yeast Nuclear code. (Genebank transl_table=12).
10. [**Ascidian mtDNA**] Ascidian mitochondrial DNA code. (Genebank transl_table=13).
11. [**Flatworm mtDNA**] Flatworm mitochondrial DNA code. (Genebank transl_table=14).
12. [**Blepharisma Nuclear**] Blepharisma Nuclear code. (Genebank transl_table=15).
13. [**Chlorophycean mtDNA**] Chlorophycean Mitochondrial Code (transl_table=16).
14. [**Trematode mtDNA**] Trematode Mitochondrial Code (transl_table=21).
15. [**Scenedesmus obliquus mtDNA**] Scenedesmus obliquus mitochondrial Code (transl_table=22).
16. [**Thraustochytrium mtDNA**] Thraustochytrium Mitochondrial Code (transl_table=23).
17. [**Pterobranchia mtDNA**] Pterobranchia Mitochondrial Code (transl_table=24).
18. [**SR1 and Gracilibacteria**] Candidate Division SR1 and Gracilibacteria Code (transl_table=25).
19. [**Pachysolen Nuclear**] Pachysolen tannophilus Nuclear Code (transl_table=26).

>Please choose an option (or press q to cancel selection):

>Select a coding sequence alignment file (`/usr/local/lib/hyphy/TemplateBatchFiles/SelectionAnalyses/`) 

>Please select a tree file for the data: (`/usr/local/lib/hyphy/TemplateBatchFiles/SelectionAnalyses/`) 
>Loaded a multiple sequence alignment with **34** sequences, **345** codons, and **1** partitions from `/app/data/fasta/Gp41NNRTIs.aln.fasta.txt`


####Choose the set of branches to use as the _test_ set

1. [**Pre**] Set Pre with 17 branches
2. [**Post**] Set Post with 17 branches
3. [**Unlabeled branches**] Set of 31 unlabeled branches

>Please choose an option (or press q to cancel selection):

####Choose the set of branches to use as the _reference_ set

1. [**Pre**] Set Pre with 17 branches
2. [**Unlabeled branches**] Set of 31 unlabeled branches

>Please choose an option (or press q to cancel selection):

### Branch sets for RELAX analysis
* Selected 17 branches as the _test_ set: `42036_NNRTIs_Post, 35596_NNRTIs_Post, 122034_NNRTIs_Post, 37879_NNRTIs_Post, 57448_NNRTIs_Post, 42183_NNRTIs_Post, 253540_NNRTIs_Post, 264159_NNRTIs_Post, 55928_NNRTIs_Post, 21890_NNRTIs_Post, 214046_NNRTIs_Post, 9918_NNRTIs_Post, 252392_NNRTIs_Post, 61631_NNRTIs_Post, 8349_NNRTIs_Post, 25036_NNRTIs_Post, 61483_NNRTIs_Post`
* Selected 17 branches as the _reference_ set: `42036_NNRTIs_Pre, 35596_NNRTIs_Pre, 122034_NNRTIs_Pre, 37879_NNRTIs_Pre, 57448_NNRTIs_Pre, 42183_NNRTIs_Pre, 253540_NNRTIs_Pre, 264159_NNRTIs_Pre, 55928_NNRTIs_Pre, 21890_NNRTIs_Pre, 214046_NNRTIs_Pre, 9918_NNRTIs_Pre, 252392_NNRTIs_Pre, 61631_NNRTIs_Pre, 8349_NNRTIs_Pre, 25036_NNRTIs_Pre, 61483_NNRTIs_Pre`
* 31 branches are in the unclassified (nuisance) set: `Node5, Node8, Node4, Node13, Node16, Node12, Node19, Node11, Node3, Node24, Node27, Node23, Node30, Node22, Node2, Node34, Node37, Node33, Node1, Node42, Node45, Node41, Node49, Node52, Node48, Node40, Node56, Node60, Node63, Node59, Node55`


####RELAX analysis type

1. [**All**] [Default] Fit descriptive models AND run the relax test (4 models)
2. [**Minimal**] Run only the RELAX test (2 models)

>Please choose an option (or press q to cancel selection):

### Obtaining branch lengths and nucleotide substitution biases under the nucleotide GTR model
* Log(L) = -7225.54, AIC-c = 14597.40 (73 estimated parameters)

### Obtaining the global omega estimate based on relative GTR branch lengths and nucleotide substitution biases
* Log(L) = -7077.97, AIC-c = 14321.11 (82 estimated parameters)
* non-synonymous/synonymous rate ratio for *Reference* =   0.5163
* non-synonymous/synonymous rate ratio for *Test* =   0.4699
* non-synonymous/synonymous rate ratio for *Unclassified* =   0.5503

### Improving branch lengths, nucleotide substitution biases, and global dN/dS ratios under a full codon model
* Log(L) = -7075.39, AIC-c = 14315.94 (82 estimated parameters)
* non-synonymous/synonymous rate ratio for *Reference* =   0.5095
* non-synonymous/synonymous rate ratio for *Test* =   0.3875
* non-synonymous/synonymous rate ratio for *Unclassified* =   0.5445

### Fitting the alternative model to test K != 1
* Log(L) = -6989.27, AIC-c = 14170.10 (95 estimated parameters)
* Relaxation/intensification parameter (K) =     0.22
* The following rate distribution was inferred for **test** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   50.636    |                                   |
|        Negative selection         |     0.931     |   49.135    |                                   |
|      Diversifying selection       |     3.546     |    0.229    |                                   |

* The following rate distribution was inferred for **reference** branches

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.000     |   50.636    |                                   |
|        Negative selection         |     0.718     |   49.135    |                                   |
|      Diversifying selection       |    338.920    |    0.229    |                                   |


### Fitting the null (K := 1) model
* Log(L) = -6990.60, AIC-c = 14170.74 (94 estimated parameters)
* The following rate distribution for test/reference branches was inferred

|          Selection mode           |     dN/dS     |Proportion, %|               Notes               |
|-----------------------------------|---------------|-------------|-----------------------------------|
|        Negative selection         |     0.027     |   39.114    |                                   |
|        Negative selection         |     0.733     |   60.859    |                                   |
|      Diversifying selection       |   10000.000   |    0.027    |                                   |

----
## Test for relaxation (or intensification) of selection [RELAX]
Likelihood ratio test **p =   0.1023**.
>No significant evidence for relaxation (or intensification) of selection among **test** branches _relative_ to the **reference** branches at P<=0.05
----

